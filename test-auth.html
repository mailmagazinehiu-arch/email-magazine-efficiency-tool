<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Auth Test</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
</head>
<body>
    <h1>Firebaseèªè¨¼ãƒ†ã‚¹ãƒˆ</h1>
    <button onclick="testAuth()">Googleãƒ­ã‚°ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆ</button>
    <button onclick="checkStatus()">çŠ¶æ…‹ç¢ºèª</button>
    <button onclick="logout()">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
    <pre id="output"></pre>

    <script>
        // Firebaseè¨­å®š - å‹•ä½œç¢ºèªæ¸ˆã¿ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ç”¨
        const firebaseConfig = {
            apiKey: "AIzaSyA5PXKChizYDCXF_GJ4KL6Ylq9K5hCPXWE",
            authDomain: "shares-b1b97.firebaseapp.com",
            databaseURL: "https://shares-b1b97-default-rtdb.firebaseio.com",
            projectId: "shares-b1b97"
        };

        // åˆæœŸåŒ–
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        
        const output = document.getElementById('output');
        
        function log(msg) {
            console.log(msg);
            output.textContent += msg + '\n';
        }

        // åˆæœŸãƒã‚§ãƒƒã‚¯
        log('ğŸ” ç’°å¢ƒç¢ºèª:');
        log('- Current Domain: ' + window.location.hostname);
        log('- Protocol: ' + window.location.protocol);
        log('- Firebase SDK: ' + (firebase.SDK_VERSION || 'Unknown'));
        log('- Auth Domain: ' + firebaseConfig.authDomain);
        log('');

        // èªè¨¼çŠ¶æ…‹ç›£è¦–
        auth.onAuthStateChanged((user) => {
            if (user) {
                log('âœ… ãƒ­ã‚°ã‚¤ãƒ³ä¸­: ' + user.email);
            } else {
                log('âŒ æœªãƒ­ã‚°ã‚¤ãƒ³');
            }
        });

        // ãƒ†ã‚¹ãƒˆé–¢æ•°
        async function testAuth() {
            try {
                log('ğŸš€ Googleãƒ­ã‚°ã‚¤ãƒ³é–‹å§‹...');
                const provider = new firebase.auth.GoogleAuthProvider();
                const result = await auth.signInWithPopup(provider);
                log('âœ… æˆåŠŸ: ' + result.user.email);
            } catch (error) {
                log('âŒ ã‚¨ãƒ©ãƒ¼: ' + error.code);
                log('   ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ' + error.message);
                if (error.code === 'auth/unauthorized-domain') {
                    log('');
                    log('âš ï¸ è§£æ±ºæ–¹æ³•:');
                    log('1. Firebaseã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹');
                    log('2. Authentication â†’ Settings â†’ Authorized domains');
                    log('3. ç¾åœ¨ã®ãƒ‰ãƒ¡ã‚¤ãƒ³è¿½åŠ : ' + window.location.hostname);
                }
            }
        }

        function checkStatus() {
            const user = auth.currentUser;
            if (user) {
                log('ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼: ' + user.email);
            } else {
                log('ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã¾ã›ã‚“');
            }
        }

        async function logout() {
            try {
                await auth.signOut();
                log('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ');
            } catch (error) {
                log('ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã‚¨ãƒ©ãƒ¼: ' + error.message);
            }
        }
    </script>
</body>
</html>